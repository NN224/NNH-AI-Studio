# ğŸ“Š Google My Business Dashboard - Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„

**Ø§Ù„ØªØ§Ø±ÙŠØ®:** 16 Ù†ÙˆÙÙ…Ø¨Ø± 2025  
**Ø§Ù„Ø­Ø§Ù„Ø©:** Production Ready ğŸš€  
**Ø§Ù„Ø¥ØµØ¯Ø§Ø±:** 2.0  

---

## ğŸ“‘ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª

1. [Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©](#Ù†Ø¸Ø±Ø©-Ø¹Ø§Ù…Ø©)
2. [Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªÙ‚Ù†ÙŠØ©](#Ø§Ù„Ø¨Ù†ÙŠØ©-Ø§Ù„ØªÙ‚Ù†ÙŠØ©)
3. [Ø§Ù„ØµÙØ­Ø§Øª ÙˆØ§Ù„Ù…ÙƒÙˆÙ†Ø§Øª](#Ø§Ù„ØµÙØ­Ø§Øª-ÙˆØ§Ù„Ù…ÙƒÙˆÙ†Ø§Øª)
4. [Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª](#Ù‚Ø§Ø¹Ø¯Ø©-Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª)
5. [API Routes](#api-routes)
6. [Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©](#Ø§Ù„Ù…ÙŠØ²Ø§Øª-Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©)
7. [ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª](#ØªØ¯ÙÙ‚-Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª)
8. [Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„ØªØ­Ø³ÙŠÙ†](#Ø§Ù„Ø£Ø¯Ø§Ø¡-ÙˆØ§Ù„ØªØ­Ø³ÙŠÙ†)
9. [Ø§Ù„Ø£Ù…Ø§Ù†](#Ø§Ù„Ø£Ù…Ø§Ù†)
10. [Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø·ÙˆØ±](#Ø¯Ù„ÙŠÙ„-Ø§Ù„Ù…Ø·ÙˆØ±)

---

## ğŸ¯ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

### Ù…Ø§ Ù‡Ùˆ GMB DashboardØŸ

**GMB Dashboard** Ù‡Ùˆ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø­Ø³Ø§Ø¨Ø§Øª Google My BusinessØŒ Ù…Ø¯Ø¹ÙˆÙ…Ø© Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠØŒ ØªÙˆÙØ±:

```
âœ… Ø¥Ø¯Ø§Ø±Ø© Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ (Multi-Location Management)
âœ… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ (AI-Powered Reviews)
âœ… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ù„Ø£Ø¬ÙˆØ¨Ø© (Q&A Management)
âœ… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª (Posts Management)
âœ… Ù…Ø¹Ø±Ø¶ Ø§Ù„ÙˆØ³Ø§Ø¦Ø· (Media Gallery)
âœ… ØªØ­Ù„ÙŠÙ„Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© (Advanced Analytics)
âœ… Ø£ØªÙ…ØªØ© Ø°ÙƒÙŠØ© (Smart Automation)
âœ… Ù…Ø³Ø§Ø¹Ø¯ AI Ù…Ø­Ø§Ø¯Ø«Ø© (AI Chat Assistant)
âœ… Ø±Ø¤Ù‰ AI ØªÙ†Ø¨Ø¤ÙŠØ© (AI Predictive Insights)
âœ… Ù…Ø²Ø§Ù…Ù†Ø© ÙÙˆØ±ÙŠØ© (Real-time Sync)
âœ… ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØªØµØ¯ÙŠØ± (Reports & Export)
```

### Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª

```
ğŸ“¦ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù„ÙØ§Øª:      ~45 Ù…Ù„Ù
ğŸ“ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø³Ø·Ø±:        ~8,889 Ø³Ø·Ø±
ğŸ§© Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª:             33 Ù…ÙƒÙˆÙ†
ğŸ“Š API Routes:           5 routes
ğŸ—„ï¸ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„:              20 Ø¬Ø¯ÙˆÙ„
ğŸ“ˆ Views:                3 views
âš¡ Functions:            ~85 function
```

---

## ğŸ—ï¸ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªÙ‚Ù†ÙŠØ©

### Technology Stack

```typescript
Frontend:
â”œâ”€â”€ Next.js 14 (App Router)
â”œâ”€â”€ React 18 (Server & Client Components)
â”œâ”€â”€ TypeScript (Type Safety)
â”œâ”€â”€ Tailwind CSS (Styling)
â”œâ”€â”€ shadcn/ui (UI Components)
â”œâ”€â”€ Framer Motion (Animations)
â”œâ”€â”€ Recharts (Charts)
â”œâ”€â”€ next-intl (i18n - English/Arabic)
â””â”€â”€ Lucide React (Icons)

Backend:
â”œâ”€â”€ Supabase (Database + Auth + Realtime)
â”œâ”€â”€ PostgreSQL (Database)
â”œâ”€â”€ Server Actions (Next.js)
â”œâ”€â”€ Edge Functions (Supabase)
â””â”€â”€ RESTful APIs

AI Integration:
â”œâ”€â”€ OpenAI GPT-4
â”œâ”€â”€ Anthropic Claude
â”œâ”€â”€ Google AI (Gemini)
â””â”€â”€ Hybrid Pricing Model

Performance:
â”œâ”€â”€ SWR (Data Caching)
â”œâ”€â”€ React.memo (Component Memoization)
â”œâ”€â”€ Dynamic Imports (Code Splitting)
â”œâ”€â”€ Materialized Views (Database)
â””â”€â”€ Redis (Future: Caching Layer)
```

### Architecture Pattern

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              User Interface (UI)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Dashboardâ”‚  â”‚ Locationsâ”‚  â”‚ Reviews  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Client-Side State Management          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Hooks   â”‚  â”‚  Cache   â”‚  â”‚  Context â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              API Layer (Routes)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚Dashboard â”‚  â”‚   GMB    â”‚  â”‚    AI    â”‚     â”‚
â”‚  â”‚   API    â”‚  â”‚   API    â”‚  â”‚   API    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Server Actions (Business Logic)       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Sync    â”‚  â”‚ Reviews  â”‚  â”‚   AI     â”‚     â”‚
â”‚  â”‚  Logic   â”‚  â”‚  Logic   â”‚  â”‚  Logic   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Database Layer (Supabase)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚PostgreSQLâ”‚  â”‚   RLS    â”‚  â”‚ Realtime â”‚     â”‚
â”‚  â”‚  Tables  â”‚  â”‚ Policies â”‚  â”‚  Subs    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         External Services (Google, AI)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Google  â”‚  â”‚  OpenAI  â”‚  â”‚Anthropic â”‚     â”‚
â”‚  â”‚   GMB    â”‚  â”‚   API    â”‚  â”‚   API    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“„ Ø§Ù„ØµÙØ­Ø§Øª ÙˆØ§Ù„Ù…ÙƒÙˆÙ†Ø§Øª

### 1. Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Main Dashboard Page)

**Ø§Ù„Ù…Ø³Ø§Ø±:** `app/[locale]/(dashboard)/dashboard/page.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…ØŒ ØªØ¹Ø±Ø¶ Ù†Ø¸Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

**Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:**
```typescript
â”œâ”€â”€ DashboardHeader              // Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø©
â”œâ”€â”€ DashboardBanner              // Ø¨Ø§Ù†Ø± Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©
â”œâ”€â”€ GMBConnectionBanner          // Ø¨Ø§Ù†Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ GMB
â”œâ”€â”€ GMBConnectionManager         // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§ØªØµØ§Ù„
â”œâ”€â”€ HealthScoreCard              // Ø¨Ø·Ø§Ù‚Ø© Ø¯Ø±Ø¬Ø© Ø§Ù„ØµØ­Ø©
â”œâ”€â”€ DateRangeControls            // Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©
â”œâ”€â”€ ExportShareBar               // Ø´Ø±ÙŠØ· Ø§Ù„ØªØµØ¯ÙŠØ± ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙƒØ©
â”œâ”€â”€ RealtimeUpdatesIndicator     // Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ©
â”œâ”€â”€ QuickActionsBar              // Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©
â”œâ”€â”€ LazyStatsCards               // Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª (Lazy Loaded)
â”œâ”€â”€ WeeklyTasksWidget            // ÙˆÙŠØ¯Ø¬Øª Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©
â”œâ”€â”€ BottlenecksWidget            // ÙˆÙŠØ¯Ø¬Øª Ø§Ù„Ø§Ø®ØªÙ†Ø§Ù‚Ø§Øª
â”œâ”€â”€ LazyPerformanceChart         // Ù…Ø®Ø·Ø· Ø§Ù„Ø£Ø¯Ø§Ø¡ (Lazy Loaded)
â”œâ”€â”€ LazyLocationHighlights       // Ø£Ø¨Ø±Ø² Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ (Lazy Loaded)
â”œâ”€â”€ LazyAIInsights               // Ø±Ø¤Ù‰ AI (Lazy Loaded)
â”œâ”€â”€ LazyGamificationWidget       // ÙˆÙŠØ¯Ø¬Øª Ø§Ù„ØªÙ„Ø¹ÙŠØ¨ (Lazy Loaded)
â”œâ”€â”€ AIInsightsPanel              // Ù„ÙˆØ­Ø© Ø±Ø¤Ù‰ AI Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
â”œâ”€â”€ AutomationInsights           // Ø±Ø¤Ù‰ Ø§Ù„Ø£ØªÙ…ØªØ©
â””â”€â”€ ChatAssistant                // Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© AI
```

**Ø§Ù„Ù…ÙŠØ²Ø§Øª:**
```
âœ… Server Component (SSR)
âœ… Authentication Check
âœ… Parallel Data Fetching
âœ… Suspense with Loading Skeletons
âœ… Error Boundaries
âœ… Responsive Grid Layout
âœ… Real-time Updates (Supabase Subscriptions)
âœ… Date Range Filtering
âœ… Export to PDF/CSV
âœ… Share Dashboard Link
âœ… Customizable Widgets
âœ… Dark Mode Support
âœ… RTL Support (Arabic)
âœ… Keyboard Shortcuts
âœ… Accessibility (WCAG 2.1 AA)
```

**Data Flow:**
```typescript
1. User Authentication Check
   â†“
2. Fetch GMB Connection Status
   â†“
3. If Connected:
   - Fetch Dashboard Snapshot (useDashboardSnapshot)
   - Fetch Stats from v_dashboard_stats view
   - Subscribe to Real-time Updates
   â†“
4. Display Data in Widgets
   â†“
5. User Interactions:
   - Sync GMB Data
   - Change Date Range
   - Quick Actions (Reply, Answer, Post)
   - Export Reports
   - Chat with AI
```

---

### 2. Ù…ÙƒÙˆÙ†Ø§Øª Dashboard (Dashboard Components)

#### ğŸ“Š Stats Cards (Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/stats-cards.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ø¹Ø±Ø¶ KPIs Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

**Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª:**
```typescript
1. Total Locations
   - Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
   - Trend (Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©)

2. Average Rating
   - Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
   - Trend (Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©)
   - All-time Average

3. Total Reviews
   - Ø¹Ø¯Ø¯ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ
   - Trend (Ù…Ù‚Ø§Ø±Ù†Ø© Ø¨Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©)
   - Pending Reviews Count

4. Response Rate
   - Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
   - Target (100%)
   - Progress Bar

5. Health Score
   - Ø¯Ø±Ø¬Ø© ØµØ­Ø© Ø§Ù„Ø­Ø³Ø§Ø¨ (0-100)
   - Color-coded (Red/Yellow/Green)
   - Tooltip with Details
```

**Features:**
```typescript
âœ… Real-time Data
âœ… Trend Indicators (â†‘ â†“)
âœ… Color-coded Status
âœ… Tooltips
âœ… Responsive Design
âœ… Loading Skeletons
âœ… Error States
âœ… Click to Navigate
```

---

#### ğŸ¯ Quick Actions Bar (Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ¹Ø©)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/quick-actions-bar.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø© Ù„Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©

**Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª:**
```typescript
1. Reply to Reviews
   - Badge: Pending Reviews Count
   - Opens: ReviewsQuickActionModal
   - Action: AI-Powered Reply

2. Answer Questions
   - Badge: Unanswered Questions Count
   - Opens: QuestionsQuickActionModal
   - Action: Quick Answer

3. Create Post
   - Badge: None
   - Opens: CreatePostModal
   - Action: Create GMB Post

4. Sync GMB Data
   - Badge: Last Sync Time
   - Action: Full Sync
   - Cooldown: 60 seconds

5. View Analytics
   - Badge: None
   - Action: Navigate to Analytics
   - Shortcut: Ctrl+A

6. Manage Locations
   - Badge: Incomplete Profiles Count
   - Action: Navigate to Locations
   - Shortcut: Ctrl+L
```

**Features:**
```typescript
âœ… Badge Notifications
âœ… Modal Dialogs
âœ… Keyboard Shortcuts
âœ… Loading States
âœ… Cooldown Timers
âœ… Success/Error Toasts
âœ… Responsive Layout
```

---

#### ğŸ“… Weekly Tasks Widget (ÙˆÙŠØ¯Ø¬Øª Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/weekly-tasks-widget.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© Ø§Ù„Ù…ÙÙ†Ø´Ø£Ø© Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ

**Ø§Ù„Ù…ÙŠØ²Ø§Øª:**
```typescript
âœ… AI-Generated Tasks
âœ… Priority Levels (HIGH, MEDIUM, LOW)
âœ… Estimated Time
âœ… Task Status (Pending, Completed)
âœ… Progress Bar
âœ… Mark as Complete
âœ… Generate New Tasks Button
âœ… Empty State
```

**Task Generation Logic:**
```typescript
High Priority:
- Respond to negative reviews (Rating â‰¤ 2)
- Reply to pending reviews (> 5)
- Answer customer questions (> 0)

Medium Priority:
- Improve location rating (< 4.0)
- Increase response rate (< 80%)

Low Priority:
- Keep up the great work! (No issues)
```

---

#### âš ï¸ Bottlenecks Widget (ÙˆÙŠØ¯Ø¬Øª Ø§Ù„Ø§Ø®ØªÙ†Ø§Ù‚Ø§Øª)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/bottlenecks-widget.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ ÙˆØ§Ù„Ø§Ø®ØªÙ†Ø§Ù‚Ø§Øª Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ø§Ù†ØªØ¨Ø§Ù‡

**Ø§Ù„Ø£Ù†ÙˆØ§Ø¹:**
```typescript
1. Reviews Bottleneck
   - Severity: High
   - Message: "X pending reviews need response"
   - Link: /reviews

2. Response Bottleneck
   - Severity: Medium
   - Message: "Response rate below 80%"
   - Link: /reviews

3. Content Bottleneck
   - Severity: Low
   - Message: "No posts in the last 7 days"
   - Link: /posts

4. Compliance Bottleneck
   - Severity: High
   - Message: "Profile incomplete"
   - Link: /features

5. General Bottleneck
   - Severity: Variable
   - Message: Custom message
   - Link: Custom link
```

**Features:**
```typescript
âœ… Severity Color Coding
âœ… Icon Indicators
âœ… Action Links
âœ… Dismiss Option
âœ… Auto-refresh
âœ… Empty State
```

---

#### ğŸ“ˆ Performance Comparison Chart (Ù…Ø®Ø·Ø· Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø£Ø¯Ø§Ø¡)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/performance-comparison-chart.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø¨ÙŠÙ† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ ÙˆØ§Ù„Ø³Ø§Ø¨Ù‚

**Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:**
```typescript
Current Month vs Previous Month:
â”œâ”€â”€ Reviews Count
â”œâ”€â”€ Average Rating
â””â”€â”€ Questions Count

Chart Type: Bar Chart (Recharts)
Colors:
â”œâ”€â”€ Current: Orange (#f97316)
â””â”€â”€ Previous: Gray (#64748b)
```

**Features:**
```typescript
âœ… Interactive Tooltips
âœ… Responsive Design
âœ… Animation on Load
âœ… Legend
âœ… Grid Lines
âœ… Custom Colors
âœ… Loading Skeleton
```

---

#### ğŸ† Location Highlights (Ø£Ø¨Ø±Ø² Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/lazy-dashboard-components.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ø¹Ø±Ø¶ Ø£ÙØ¶Ù„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ ÙˆØ§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ Ø§Ù†ØªØ¨Ø§Ù‡

**Ø§Ù„ÙØ¦Ø§Øª:**
```typescript
1. Top Performers (Ø£ÙØ¶Ù„ Ø£Ø¯Ø§Ø¡)
   - Rating â‰¥ 4.5
   - High Review Count
   - Badge: ğŸ† Top

2. Needs Attention (ØªØ­ØªØ§Ø¬ Ø§Ù†ØªØ¨Ø§Ù‡)
   - Rating < 3.5
   - High Pending Reviews
   - Badge: âš ï¸ Attention

3. Most Improved (Ø§Ù„Ø£ÙƒØ«Ø± ØªØ­Ø³Ù†Ø§Ù‹)
   - Positive Rating Change
   - Badge: ğŸ“ˆ Improved
```

**Features:**
```typescript
âœ… Category Badges
âœ… Rating Stars
âœ… Review Count
âœ… Pending Reviews Count
âœ… Rating Change Indicator
âœ… Click to Navigate
âœ… Empty State
```

---

#### ğŸ¤– AI Features (Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ)

##### 1. AI Insights Panel (Ù„ÙˆØ­Ø© Ø±Ø¤Ù‰ AI)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/ai/ai-insights-panel.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ø±Ø¤Ù‰ ÙˆØªÙˆØµÙŠØ§Øª Ù…Ø¯Ø¹ÙˆÙ…Ø© Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ

**Ø§Ù„Ø±Ø¤Ù‰:**
```typescript
1. Business Insights
   - Daily AI-generated insights
   - Based on v_dashboard_stats data
   - Impact Level (High, Medium, Low)
   - Confidence Score (0-100%)

2. Predictive Analytics
   - Review trends prediction
   - Rating forecast
   - Customer behavior analysis

3. Anomaly Detection
   - Sudden rating drops
   - Unusual review patterns
   - Spam detection

4. Competitor Comparison
   - Industry benchmarks
   - Competitor analysis
   - Market position

5. Action Recommendations
   - Prioritized actions
   - One-click implementation
   - Expected impact
```

**API:** `app/api/ai/insights/route.ts`

**Features:**
```typescript
âœ… Real-time Generation
âœ… Caching (1 hour)
âœ… Cost Tracking
âœ… Usage Limits
âœ… Fallback to System Key
âœ… Error Handling
âœ… Loading States
âœ… Refresh Button
```

---

##### 2. Chat Assistant (Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/ai/chat-assistant.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ù…Ø³Ø§Ø¹Ø¯ Ù…Ø­Ø§Ø¯Ø«Ø© Ø°ÙƒÙŠ Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©

**Ø§Ù„Ù…ÙŠØ²Ø§Øª:**
```typescript
âœ… Natural Language Queries
âœ… Context-Aware Responses
âœ… Dashboard Data Access
âœ… Quick Action Suggestions
âœ… Voice Input (Optional)
âœ… Conversation History
âœ… Copy Response
âœ… Minimize/Maximize
âœ… Floating Widget
```

**API:** `app/api/ai/chat/route.ts`

**Examples:**
```
User: "How many pending reviews do I have?"
AI: "You have 12 pending reviews. Would you like to reply to them now?"

User: "What's my average rating?"
AI: "Your average rating is 4.3 stars across 156 reviews."

User: "Show me locations that need attention"
AI: "Here are 3 locations with ratings below 4.0: [List]"
```

---

##### 3. Automation Insights (Ø±Ø¤Ù‰ Ø§Ù„Ø£ØªÙ…ØªØ©)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/ai/automation-insights.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„Ø£ØªÙ…ØªØ© ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª

**Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:**
```typescript
1. Active Automations Count
   - Number of active rules
   - Auto-reply enabled locations

2. Success Rate
   - Percentage of successful automations
   - Last 30 days

3. Time Saved
   - Estimated time saved by automation
   - Based on action count

4. Upcoming Actions
   - Scheduled automations
   - Next 7 days

5. AI Response Quality
   - Average quality score
   - User feedback
```

**API:** `app/api/ai/automation-status/route.ts`

**Features:**
```typescript
âœ… Real-time Stats
âœ… Progress Bars
âœ… Color-coded Status
âœ… Tooltips
âœ… Refresh Button
âœ… Navigate to Automation Page
```

---

#### ğŸ”„ Realtime Updates Indicator (Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ©)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/realtime-updates-indicator.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ© ÙˆØ¢Ø®Ø± Ù…Ø²Ø§Ù…Ù†Ø©

**Ø§Ù„Ù…ÙŠØ²Ø§Øª:**
```typescript
âœ… Last Updated Timestamp
âœ… Auto-refresh Interval (5 minutes)
âœ… Manual Refresh Button
âœ… Sync Details per Module:
   - Reviews
   - Posts
   - Questions
   - Automation
âœ… Loading State
âœ… Error State
âœ… Success Toast
```

**Realtime Subscriptions:**
```typescript
Supabase Realtime Channels:
â”œâ”€â”€ gmb_reviews (INSERT, UPDATE)
â”œâ”€â”€ gmb_posts (INSERT, UPDATE)
â”œâ”€â”€ gmb_questions (INSERT, UPDATE)
â””â”€â”€ gmb_locations (UPDATE)
```

---

#### ğŸ“… Date Range Controls (Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ©)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/date-range-controls.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ© Ù„ØªØµÙÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

**Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª:**
```typescript
Presets:
â”œâ”€â”€ Last 7 Days
â”œâ”€â”€ Last 30 Days
â”œâ”€â”€ Last 90 Days
â”œâ”€â”€ This Month
â”œâ”€â”€ Last Month
â”œâ”€â”€ This Year
â””â”€â”€ Custom Range

Custom Range:
â”œâ”€â”€ Start Date Picker
â”œâ”€â”€ End Date Picker
â””â”€â”€ Apply Button
```

**Features:**
```typescript
âœ… Preset Buttons
âœ… Custom Date Picker
âœ… Comparison Period
âœ… Apply/Reset Buttons
âœ… Keyboard Shortcuts
âœ… URL Params Sync
âœ… Validation
```

---

#### ğŸ“¤ Export & Share Bar (Ø´Ø±ÙŠØ· Ø§Ù„ØªØµØ¯ÙŠØ± ÙˆØ§Ù„Ù…Ø´Ø§Ø±ÙƒØ©)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/export-share-bar.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** ØªØµØ¯ÙŠØ± ÙˆÙ…Ø´Ø§Ø±ÙƒØ© ØªÙ‚Ø§Ø±ÙŠØ± Dashboard

**Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª:**
```typescript
Export:
â”œâ”€â”€ Export to PDF
â”œâ”€â”€ Export to CSV
â”œâ”€â”€ Export to Excel
â””â”€â”€ Print

Share:
â”œâ”€â”€ Copy Link
â”œâ”€â”€ Share via Email
â””â”€â”€ Generate Public Report (Optional)
```

**Features:**
```typescript
âœ… Multiple Export Formats
âœ… Custom Date Range in Export
âœ… Include/Exclude Widgets
âœ… Branded Reports
âœ… Password Protection (Optional)
âœ… Expiry Date (Optional)
âœ… Download Progress
âœ… Success Toast
```

---

#### âš™ï¸ Dashboard Customization (ØªØ®ØµÙŠØµ Dashboard)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/dashboard-customization-modal.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** ØªØ®ØµÙŠØµ Ø¹Ø±Ø¶ Dashboard

**Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª:**
```typescript
Widget Visibility:
â”œâ”€â”€ Show/Hide Stats Cards
â”œâ”€â”€ Show/Hide Performance Chart
â”œâ”€â”€ Show/Hide Location Highlights
â”œâ”€â”€ Show/Hide Weekly Tasks
â”œâ”€â”€ Show/Hide Bottlenecks
â”œâ”€â”€ Show/Hide AI Insights
â””â”€â”€ Show/Hide Achievements

Layout:
â”œâ”€â”€ Grid Layout (Default)
â”œâ”€â”€ List Layout
â””â”€â”€ Compact Layout

Theme:
â”œâ”€â”€ Light Mode
â”œâ”€â”€ Dark Mode
â””â”€â”€ Auto (System)

Language:
â”œâ”€â”€ English
â””â”€â”€ Arabic (RTL)
```

**Storage:** `localStorage` (dashboard-preferences)

**Features:**
```typescript
âœ… Drag & Drop Widgets (Future)
âœ… Resize Widgets (Future)
âœ… Save Layout
âœ… Reset to Default
âœ… Export/Import Settings
```

---

#### ğŸ¨ Dashboard Banner (Ø¨Ø§Ù†Ø± Dashboard)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/dashboard-banner.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ø¹Ø±Ø¶ Ø¨Ø§Ù†Ø± Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© Ø§Ù„Ù…Ø®ØµØµØ©

**Ø§Ù„Ù…ÙŠØ²Ø§Øª:**
```typescript
âœ… Custom Branding
âœ… Logo Upload
âœ… Custom Colors
âœ… Custom Message
âœ… Dismiss Option
âœ… Show/Hide per User
âœ… Responsive Design
```

---

#### ğŸ›¡ï¸ Error Boundary (Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø®Ø·Ø£)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/dashboard-error-boundary.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø¨Ø´ÙƒÙ„ graceful

**Ø§Ù„Ù…ÙŠØ²Ø§Øª:**
```typescript
âœ… Catch Component Errors
âœ… Display User-Friendly Message
âœ… Retry Button
âœ… Report Error to Logs
âœ… Fallback UI
âœ… Section-Level Boundaries
```

**Sections:**
```typescript
â”œâ”€â”€ Stats Cards
â”œâ”€â”€ Performance Chart
â”œâ”€â”€ Location Highlights
â”œâ”€â”€ Weekly Tasks
â”œâ”€â”€ Bottlenecks
â”œâ”€â”€ AI Insights
â””â”€â”€ Automation Insights
```

---

#### ğŸ“± Responsive Layout (Ø§Ù„ØªØ®Ø·ÙŠØ· Ø§Ù„Ù…ØªØ¬Ø§ÙˆØ¨)

**Ø§Ù„Ù…Ù„Ù:** `components/dashboard/responsive-layout.tsx`

**Ø§Ù„ÙˆØ¸ÙŠÙØ©:** ØªØ®Ø·ÙŠØ· Ù…ØªØ¬Ø§ÙˆØ¨ Ù„Ø¬Ù…ÙŠØ¹ Ø£Ø­Ø¬Ø§Ù… Ø§Ù„Ø´Ø§Ø´Ø§Øª

**Breakpoints:**
```typescript
Mobile:  < 640px  (1 column)
Tablet:  640-1024px (2 columns)
Desktop: > 1024px (3-4 columns)
```

**Grid Types:**
```typescript
1. Stats Grid
   - Mobile: 1 column
   - Tablet: 2 columns
   - Desktop: 4 columns

2. Main Grid
   - Mobile: 1 column
   - Tablet: 1 column
   - Desktop: 2 columns

3. Chart Grid
   - Mobile: 1 column
   - Tablet: 1 column
   - Desktop: 2 columns
```

**Features:**
```typescript
âœ… Responsive Grid
âœ… Touch Gestures (Mobile)
âœ… Pull-to-Refresh (Mobile)
âœ… Bottom Sheet Navigation (Mobile)
âœ… Collapsible Sidebar (Tablet)
âœ… Fixed Header (All)
```

---

### 3. Server Actions (Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø®Ø§Ø¯Ù…)

**Ø§Ù„Ù…Ù„Ù:** `app/[locale]/(dashboard)/dashboard/actions.ts`

#### Functions:

##### 1. `refreshDashboard()`
```typescript
Purpose: ØªØ­Ø¯ÙŠØ« Dashboard
Returns: { success: boolean, message: string }
Revalidates: /dashboard
```

##### 2. `syncLocation(locationId: string)`
```typescript
Purpose: Ù…Ø²Ø§Ù…Ù†Ø© Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ø­Ø¯ Ù…Ù† Google
Steps:
  1. Authenticate user
  2. Get location and account
  3. Refresh access token if needed
  4. Call syncReviewsFromGoogle()
  5. Revalidate paths
Returns: { success: boolean, message?: string, error?: string }
Revalidates: /dashboard, /reviews
```

##### 3. `syncAllGmbData(syncType: 'full' | 'reviews' | 'locations')`
```typescript
Purpose: Ù…Ø²Ø§Ù…Ù†Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Google
Rate Limit: 60 seconds cooldown
Steps:
  1. Get active GMB account
  2. Call /api/gmb/sync
  3. Handle rate limiting
  4. Dispatch gmb-sync-complete event
Returns: { success: boolean, message?: string, error?: string, rateLimited?: boolean, cooldownRemaining?: number }
```

##### 4. `disconnectLocation(locationId: string)`
```typescript
Purpose: ÙØµÙ„ Ù…ÙˆÙ‚Ø¹ Ù…Ù† GMB
Steps:
  1. Authenticate user
  2. Get location and account
  3. Call disconnectGMBAccount()
  4. Revalidate paths
Returns: { success: boolean, message?: string, error?: string }
Revalidates: /dashboard, /locations, /settings
```

##### 5. `generateWeeklyTasks(locationId: string)`
```typescript
Purpose: Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù‡Ø§Ù… Ø£Ø³Ø¨ÙˆØ¹ÙŠØ© Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
Logic:
  - Analyze reviews (last 50)
  - Analyze questions (pending)
  - Calculate metrics:
    * Pending reviews count
    * Unanswered questions count
    * Negative reviews count
    * Average rating
    * Response rate
  - Generate prioritized tasks
Returns: { success: boolean, data: { tasks: Task[] } }
```

##### 6. `getDashboardDataWithFilter(startDate?: string, endDate?: string)`
```typescript
Purpose: Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Dashboard Ù…Ø¹ ÙÙ„ØªØ±
Returns: { success: boolean, data: { reviews, locations, questions } }
```

---

## ğŸ—„ï¸ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

#### 1. `gmb_accounts`
```sql
Purpose: Ø­Ø³Ø§Ø¨Ø§Øª Google My Business
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - email (text)
  - access_token (text, encrypted)
  - refresh_token (text, encrypted)
  - token_expires_at (timestamptz)
  - is_active (boolean)
  - last_sync_at (timestamptz)
  - created_at (timestamptz)
  - updated_at (timestamptz)

Indexes:
  - idx_gmb_accounts_user_id
  - idx_gmb_accounts_is_active

RLS Policies:
  - Users can view their own accounts
  - Users can update their own accounts
```

#### 2. `gmb_locations`
```sql
Purpose: Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø­Ø³Ø§Ø¨Ø§Øª GMB
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - account_id (uuid, FK â†’ gmb_accounts)
  - location_name (text)
  - location_id (text, Google Location ID)
  - normalized_location_id (text)
  - address (text)
  - phone (text)
  - website (text)
  - category (text)
  - rating (numeric)
  - review_count (integer)
  - response_rate (numeric)
  - health_score (numeric)
  - profile_completeness (numeric)
  - is_active (boolean)
  - last_sync_reviews (timestamptz)
  - last_sync_posts (timestamptz)
  - last_sync_questions (timestamptz)
  - created_at (timestamptz)
  - updated_at (timestamptz)

Indexes:
  - idx_gmb_locations_user_id
  - idx_gmb_locations_account_id
  - idx_gmb_locations_is_active
  - idx_gmb_locations_normalized_id

Triggers:
  - update_normalized_location_id (BEFORE INSERT/UPDATE)
  - gmb_locations_history_trigger (AFTER UPDATE)
  - set_updated_at_trigger (BEFORE UPDATE)

RLS Policies:
  - Users can view their own locations
  - Users can update their own locations
```

#### 3. `gmb_reviews`
```sql
Purpose: Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù…Ù† Google My Business
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - location_id (uuid, FK â†’ gmb_locations)
  - review_id (text, Google Review ID)
  - reviewer_name (text)
  - reviewer_profile_photo (text)
  - rating (integer, 1-5)
  - review_text (text)
  - review_date (timestamptz)
  - review_reply (text)
  - reply_date (timestamptz)
  - has_reply (boolean)
  - sentiment (text: positive/neutral/negative)
  - sentiment_score (numeric)
  - is_flagged (boolean)
  - created_at (timestamptz)
  - updated_at (timestamptz)

Indexes:
  - idx_gmb_reviews_user_id
  - idx_gmb_reviews_location_id
  - idx_gmb_reviews_rating
  - idx_gmb_reviews_has_reply
  - idx_gmb_reviews_review_date

Triggers:
  - set_updated_at_trigger (BEFORE UPDATE)
  - trigger_update_gmb_reviews_updated_at (BEFORE UPDATE)
  - trigger_update_location_review_stats_* (AFTER INSERT/UPDATE/DELETE)

RLS Policies:
  - Users can view their own reviews
  - Users can update their own reviews
```

#### 4. `gmb_questions`
```sql
Purpose: Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù…Ù† Google My Business
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - location_id (uuid, FK â†’ gmb_locations)
  - question_id (text, Google Question ID)
  - question_text (text)
  - author_name (text)
  - author_profile_photo (text)
  - answer_text (text)
  - answer_status (text: pending/answered/hidden)
  - upvote_count (integer)
  - created_at (timestamptz)
  - answered_at (timestamptz)
  - updated_at (timestamptz)

Indexes:
  - idx_gmb_questions_user_id
  - idx_gmb_questions_location_id
  - idx_gmb_questions_answer_status

RLS Policies:
  - Users can view their own questions
  - Users can update their own questions
```

#### 5. `gmb_posts`
```sql
Purpose: Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª Ø¹Ù„Ù‰ Google My Business
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - location_id (uuid, FK â†’ gmb_locations)
  - post_id (text, Google Post ID)
  - title (text)
  - content (text)
  - post_type (text: whats_new/event/offer)
  - status (text: draft/queued/published/failed)
  - media_url (text)
  - cta_type (text: BOOK/ORDER/SHOP/LEARN_MORE/SIGN_UP/CALL)
  - cta_url (text)
  - event_start_date (timestamptz)
  - event_end_date (timestamptz)
  - offer_coupon_code (text)
  - offer_redeem_url (text)
  - scheduled_at (timestamptz)
  - published_at (timestamptz)
  - created_at (timestamptz)
  - updated_at (timestamptz)

Indexes:
  - idx_gmb_posts_user_id
  - idx_gmb_posts_location_id
  - idx_gmb_posts_status

RLS Policies:
  - Users can view their own posts
  - Users can update their own posts
```

#### 6. `gmb_media`
```sql
Purpose: Ø§Ù„ÙˆØ³Ø§Ø¦Ø· (ØµÙˆØ±/ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª) Ù…Ù† GMB
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - location_id (uuid, FK â†’ gmb_locations)
  - media_id (text, Google Media ID)
  - media_format (text: PHOTO/VIDEO)
  - media_url (text)
  - thumbnail_url (text)
  - description (text)
  - width (integer)
  - height (integer)
  - file_size (bigint)
  - created_at (timestamptz)

Indexes:
  - idx_gmb_media_user_id
  - idx_gmb_media_location_id

RLS Policies:
  - Users can view their own media
```

#### 7. `gmb_search_keywords`
```sql
Purpose: Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© Ù„Ù„Ø¨Ø­Ø«
Size: 5.9 MB (Ø£ÙƒØ¨Ø± Ø¬Ø¯ÙˆÙ„)
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - location_id (uuid, FK â†’ gmb_locations)
  - keyword (text)
  - search_volume (integer)
  - impressions (integer)
  - clicks (integer)
  - ctr (numeric)
  - date (date)
  - created_at (timestamptz)

Indexes:
  - idx_gmb_search_keywords_location_id
  - idx_gmb_search_keywords_date

RLS Policies:
  - Users can view their own keywords
```

#### 8. `gmb_performance_metrics`
```sql
Purpose: Ù…Ù‚Ø§ÙŠÙŠØ³ Ø§Ù„Ø£Ø¯Ø§Ø¡
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - location_id (uuid, FK â†’ gmb_locations)
  - metric_type (text: views/searches/actions/calls/directions/website_clicks)
  - metric_value (integer)
  - date (date)
  - created_at (timestamptz)

Indexes:
  - idx_gmb_performance_metrics_location_id
  - idx_gmb_performance_metrics_date

RLS Policies:
  - Users can view their own metrics
```

#### 9. `gmb_sync_logs`
```sql
Purpose: Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - account_id (uuid, FK â†’ gmb_accounts)
  - location_id (uuid, FK â†’ gmb_locations)
  - sync_type (text: full/reviews/posts/questions/media)
  - status (text: success/failed/partial)
  - items_synced (integer)
  - error_message (text)
  - started_at (timestamptz)
  - completed_at (timestamptz)
  - created_at (timestamptz)

Indexes:
  - idx_gmb_sync_logs_user_id
  - idx_gmb_sync_logs_status

RLS Policies:
  - Users can view their own logs
```

#### 10. `ai_settings`
```sql
Purpose: Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - provider (text: openai/anthropic/google)
  - api_key (text, encrypted)
  - model (text)
  - is_active (boolean)
  - usage_limit (integer)
  - usage_count (integer)
  - created_at (timestamptz)
  - updated_at (timestamptz)

Triggers:
  - set_updated_at_trigger (BEFORE UPDATE)
  - trigger_update_ai_settings_updated_at (BEFORE UPDATE)

RLS Policies:
  - Users can view their own settings
  - Users can update their own settings
```

#### 11. `ai_requests`
```sql
Purpose: Ø³Ø¬Ù„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - provider (text: openai/anthropic/google)
  - model (text)
  - feature (text: insights/chat/automation/review_reply)
  - prompt_tokens (integer)
  - completion_tokens (integer)
  - total_tokens (integer)
  - cost_usd (numeric)
  - success (boolean)
  - error_message (text)
  - created_at (timestamptz)

Indexes:
  - idx_ai_requests_user_id
  - idx_ai_requests_created_at

RLS Policies:
  - Users can view their own requests
```

#### 12. `weekly_task_recommendations`
```sql
Purpose: ØªÙˆØµÙŠØ§Øª Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - location_id (uuid, FK â†’ gmb_locations)
  - title (text)
  - description (text)
  - priority (text: HIGH/MEDIUM/LOW)
  - estimated_time (text)
  - status (text: pending/completed)
  - completed_at (timestamptz)
  - created_at (timestamptz)
  - updated_at (timestamptz)

Triggers:
  - tr_weekly_task_updated_at (BEFORE UPDATE)

RLS Policies:
  - Users can view their own tasks
  - Users can update their own tasks
```

#### 13. `profiles`
```sql
Purpose: Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
Columns:
  - id (uuid, PK, FK â†’ auth.users)
  - email (text)
  - full_name (text)
  - avatar_url (text)
  - company_name (text)
  - phone (text)
  - timezone (text)
  - language (text: en/ar)
  - theme (text: light/dark/auto)
  - created_at (timestamptz)
  - updated_at (timestamptz)

Triggers:
  - set_timestamp_on_profiles (BEFORE UPDATE)
  - set_updated_at_trigger (BEFORE UPDATE)

RLS Policies:
  - Users can view their own profile
  - Users can update their own profile
```

#### 14. `notifications`
```sql
Purpose: Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - title (text)
  - message (text)
  - type (text: info/success/warning/error)
  - is_read (boolean)
  - link (text)
  - created_at (timestamptz)
  - updated_at (timestamptz)

Triggers:
  - notifications_updated_at (BEFORE UPDATE)

RLS Policies:
  - Users can view their own notifications
  - Users can update their own notifications
```

#### 15. `activity_logs`
```sql
Purpose: Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·Ø§Øª
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - action (text)
  - entity_type (text)
  - entity_id (uuid)
  - metadata (jsonb)
  - ip_address (inet)
  - user_agent (text)
  - created_at (timestamptz)

Indexes:
  - idx_activity_logs_user_id
  - idx_activity_logs_created_at

RLS Policies:
  - Users can view their own logs
```

#### 16. `audit_logs`
```sql
Purpose: Ø³Ø¬Ù„ Ø§Ù„ØªØ¯Ù‚ÙŠÙ‚
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - table_name (text)
  - operation (text: INSERT/UPDATE/DELETE)
  - old_data (jsonb)
  - new_data (jsonb)
  - created_at (timestamptz)

Indexes:
  - idx_audit_logs_user_id
  - idx_audit_logs_table_name

RLS Policies:
  - Users can view their own audit logs
```

#### 17. `error_logs`
```sql
Purpose: Ø³Ø¬Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - error_type (text)
  - error_message (text)
  - stack_trace (text)
  - url (text)
  - metadata (jsonb)
  - created_at (timestamptz)

Indexes:
  - idx_error_logs_user_id
  - idx_error_logs_created_at

RLS Policies:
  - Users can view their own errors
```

#### 18. `rate_limit_requests`
```sql
Purpose: ØªØªØ¨Ø¹ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - endpoint (text)
  - request_count (integer)
  - window_start (timestamptz)
  - created_at (timestamptz)

Indexes:
  - idx_rate_limit_requests_user_id
  - idx_rate_limit_requests_window_start

RLS Policies:
  - Users can view their own rate limits
```

#### 19. `oauth_states`
```sql
Purpose: Ø­Ø§Ù„Ø§Øª OAuth Ù„Ù„Ø£Ù…Ø§Ù†
Columns:
  - id (uuid, PK)
  - user_id (uuid, FK â†’ profiles)
  - state (text, unique)
  - provider (text: google)
  - expires_at (timestamptz)
  - created_at (timestamptz)

Indexes:
  - idx_oauth_states_state
  - idx_oauth_states_expires_at

RLS Policies:
  - Users can view their own states
```

#### 20. `business_profile_history`
```sql
Purpose: Ø³Ø¬Ù„ ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ù…Ù„Ù Ø§Ù„ØªØ¬Ø§Ø±ÙŠ
Columns:
  - id (uuid, PK)
  - location_id (uuid, FK â†’ gmb_locations)
  - user_id (uuid, FK â†’ profiles)
  - changed_fields (jsonb)
  - old_values (jsonb)
  - new_values (jsonb)
  - changed_at (timestamptz)
  - created_at (timestamptz)

Indexes:
  - idx_business_profile_history_location_id

RLS Policies:
  - Users can view their own history
```

---

### Views (Ø§Ù„Ø¹Ø±ÙˆØ¶)

#### 1. `v_dashboard_stats`
```sql
Purpose: Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Dashboard Ù…Ø­Ø³Ù‘Ù†Ø©
Columns:
  - user_id
  - total_locations
  - avg_rating
  - total_reviews
  - response_rate
  - pending_reviews
  - recent_reviews (last 30 days)
  - pending_questions
  - recent_questions (last 30 days)

Usage: app/api/dashboard/stats/route.ts
Cache: 5 minutes (client-side)
```

#### 2. `mv_location_stats` (Materialized View)
```sql
Purpose: Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ (Ù…Ø­Ø³ÙˆØ¨Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹)
Columns:
  - user_id
  - location_id
  - location_name
  - total_reviews
  - pending_reviews
  - avg_rating
  - response_rate
  - total_questions
  - unanswered_questions
  - last_review_date
  - last_question_date

Refresh: Manual (via refresh_location_stats function)
Usage: app/api/dashboard/stats/route.ts
```

#### 3. `v_health_score_distribution`
```sql
Purpose: ØªÙˆØ²ÙŠØ¹ Ø¯Ø±Ø¬Ø§Øª Ø§Ù„ØµØ­Ø©
Columns:
  - user_id
  - avg_health_score
  - excellent_count (>= 90)
  - good_count (70-89)
  - fair_count (50-69)
  - needs_attention_count (< 50)

Usage: app/api/dashboard/stats/route.ts
```

---

### Functions (Ø§Ù„Ø¯ÙˆØ§Ù„)

#### 1. `get_dashboard_trends(p_user_id uuid, p_days integer)`
```sql
Purpose: Ø­Ø³Ø§Ø¨ Ø§ØªØ¬Ø§Ù‡Ø§Øª Dashboard
Returns: JSON
  {
    reviews: { current, previous, change },
    questions: { current, previous, change },
    rating: { current, previous, change },
    responseRate: { current, previous, change }
  }

Logic:
  - Compare current period vs previous period
  - Calculate percentage change
  - Return trends

Usage: app/api/dashboard/stats/route.ts
```

#### 2. `refresh_location_stats()`
```sql
Purpose: ØªØ­Ø¯ÙŠØ« mv_location_stats
Returns: void

Logic:
  - REFRESH MATERIALIZED VIEW CONCURRENTLY mv_location_stats

Usage: app/api/dashboard/stats/route.ts (POST)
Trigger: Cron job (every 15 minutes)
```

#### 3. `update_location_review_stats()`
```sql
Purpose: ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ù„Ù„Ù…ÙˆÙ‚Ø¹
Trigger: AFTER INSERT/UPDATE/DELETE ON gmb_reviews
Returns: trigger

Logic:
  - Calculate avg_rating
  - Calculate review_count
  - Calculate response_rate
  - Update gmb_locations table
```

#### 4. `update_normalized_location_id()`
```sql
Purpose: ØªØ­Ø¯ÙŠØ« normalized_location_id
Trigger: BEFORE INSERT/UPDATE ON gmb_locations
Returns: trigger

Logic:
  - Extract location ID from Google format
  - Normalize to simple ID
  - Store in normalized_location_id
```

#### 5. `record_profile_changes()`
```sql
Purpose: ØªØ³Ø¬ÙŠÙ„ ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ù…Ù„Ù Ø§Ù„ØªØ¬Ø§Ø±ÙŠ
Trigger: AFTER UPDATE ON gmb_locations
Returns: trigger

Logic:
  - Compare OLD and NEW values
  - Identify changed fields
  - Insert into business_profile_history
```

#### 6. `set_updated_at()`
```sql
Purpose: ØªØ­Ø¯ÙŠØ« updated_at ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
Trigger: BEFORE UPDATE ON multiple tables
Returns: trigger

Logic:
  - NEW.updated_at = NOW()
```

#### 7. `update_gmb_reviews_updated_at()`
```sql
Purpose: ØªØ­Ø¯ÙŠØ« updated_at Ù„Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª
Trigger: BEFORE UPDATE ON gmb_reviews
Returns: trigger

Logic:
  - NEW.updated_at = NOW()
```

---

### Indexes (Ø§Ù„ÙÙ‡Ø§Ø±Ø³)

**Ø¥Ø¬Ù…Ø§Ù„ÙŠ:** ~250 ÙÙ‡Ø±Ø³

**Ø§Ù„Ø£Ù‡Ù…:**
```sql
-- Performance Critical
idx_gmb_reviews_user_id_location_id (user_id, location_id)
idx_gmb_reviews_review_date (review_date DESC)
idx_gmb_locations_user_id_is_active (user_id, is_active)
idx_gmb_questions_answer_status (answer_status)
idx_activity_logs_user_id_created_at (user_id, created_at DESC)

-- Full-Text Search
idx_gmb_reviews_review_text_fts (to_tsvector('english', review_text))
idx_gmb_questions_question_text_fts (to_tsvector('english', question_text))
```

---

### Triggers (Ø§Ù„Ù…Ø´ØºÙ„Ø§Øª)

**Ø¥Ø¬Ù…Ø§Ù„ÙŠ:** 17 Ù…Ø´ØºÙ„

**Ø§Ù„Ø£Ù‡Ù…:**
```sql
-- Auto-update timestamps
set_updated_at_trigger (BEFORE UPDATE)
  â†’ gmb_locations, gmb_reviews, ai_settings, profiles

-- Stats calculation
trigger_update_location_review_stats_insert (AFTER INSERT ON gmb_reviews)
trigger_update_location_review_stats_update (AFTER UPDATE ON gmb_reviews)
trigger_update_location_review_stats_delete (AFTER DELETE ON gmb_reviews)

-- History tracking
gmb_locations_history_trigger (AFTER UPDATE ON gmb_locations)

-- Normalization
trigger_update_normalized_location_id (BEFORE INSERT/UPDATE ON gmb_locations)
```

---

### RLS Policies (Ø³ÙŠØ§Ø³Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†)

**Ø¥Ø¬Ù…Ø§Ù„ÙŠ:** ~150 Ø³ÙŠØ§Ø³Ø©

**Ø§Ù„Ù†Ù…Ø· Ø§Ù„Ø¹Ø§Ù…:**
```sql
-- View own data
CREATE POLICY "Users can view their own {table}"
ON {table} FOR SELECT
USING (auth.uid() = user_id);

-- Update own data
CREATE POLICY "Users can update their own {table}"
ON {table} FOR UPDATE
USING (auth.uid() = user_id);

-- Insert own data
CREATE POLICY "Users can insert their own {table}"
ON {table} FOR INSERT
WITH CHECK (auth.uid() = user_id);

-- Delete own data
CREATE POLICY "Users can delete their own {table}"
ON {table} FOR DELETE
USING (auth.uid() = user_id);
```

---

## ğŸ”Œ API Routes

### 1. Dashboard Stats API

**Ø§Ù„Ù…Ø³Ø§Ø±:** `app/api/dashboard/stats/route.ts`

**Method:** GET

**Purpose:** Ø¬Ù„Ø¨ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Dashboard Ø§Ù„Ù…Ø­Ø³Ù‘Ù†Ø©

**Query Params:**
```typescript
- start?: string (ISO date)
- end?: string (ISO date)
```

**Response:**
```typescript
{
  // Core Metrics
  totalLocations: number
  averageRating: number
  totalReviews: number
  responseRate: number
  
  // Pending Items
  pendingReviews: number
  pendingQuestions: number
  
  // Health Metrics
  healthScore: number
  healthDistribution: {
    excellent: number
    good: number
    fair: number
    needsAttention: number
  }
  
  // Recent Activity
  recentActivity: {
    reviews: Array<{
      id: string
      rating: number
      text: string
      reviewer: string
      date: string
      hasReply: boolean
      locationName: string
    }>
    questions: Array<{
      id: string
      text: string
      author: string
      date: string
      status: string
      locationName: string
    }>
  }
  
  // Trends
  trends: {
    reviews: { current: number, previous: number, change: number }
    questions: { current: number, previous: number, change: number }
    rating: { current: number, previous: number, change: number }
    responseRate: { current: number, previous: number, change: number }
  }
  
  // Metadata
  lastUpdated: string
  cacheExpiry: number
}
```

**Features:**
```typescript
âœ… Uses v_dashboard_stats view
âœ… Uses mv_location_stats materialized view
âœ… Uses v_health_score_distribution view
âœ… Uses get_dashboard_trends function
âœ… Rate limiting (checkRateLimit)
âœ… Caching (5 minutes)
âœ… Error handling
âœ… Parallel queries (Promise.all)
```

**Method:** POST

**Purpose:** ØªØ­Ø¯ÙŠØ« Materialized Views

**Auth:** Required (Admin only recommended)

**Response:**
```typescript
{
  success: boolean
  message: string
  timestamp: string
}
```

---

### 2. Dashboard Overview API

**Ø§Ù„Ù…Ø³Ø§Ø±:** `app/api/dashboard/overview/route.ts`

**Method:** GET

**Purpose:** Ø¬Ù„Ø¨ Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø´Ø§Ù…Ù„Ø© Ø¹Ù„Ù‰ Dashboard

**Response:** `DashboardSnapshot` (see types/dashboard.ts)

**Features:**
```typescript
âœ… Comprehensive data snapshot
âœ… Location summary
âœ… KPIs
âœ… Review stats
âœ… Post stats
âœ… Question stats
âœ… Automation stats
âœ… Tasks summary
âœ… Bottlenecks
âœ… Monthly comparison
âœ… Location highlights
âœ… Caching (3 minutes)
```

---

### 3. AI Insights API

**Ø§Ù„Ù…Ø³Ø§Ø±:** `app/api/ai/insights/route.ts`

**Method:** GET

**Purpose:** Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø¤Ù‰ AI

**Response:**
```typescript
{
  insights: Array<{
    id: string
    type: 'business' | 'predictive' | 'anomaly' | 'competitor' | 'action'
    title: string
    description: string
    impact: 'high' | 'medium' | 'low'
    confidence: number (0-100)
    actions?: Array<{
      label: string
      action: string
      params?: any
    }>
    metadata?: any
  }>
  generatedAt: string
  cacheExpiry: number
}
```

**Features:**
```typescript
âœ… AI-powered insights
âœ… Uses v_dashboard_stats
âœ… OpenAI/Anthropic/Google integration
âœ… Caching (1 hour)
âœ… Cost tracking (ai_requests table)
âœ… Usage limits
âœ… Fallback to system key
âœ… Error handling
```

---

### 4. AI Chat API

**Ø§Ù„Ù…Ø³Ø§Ø±:** `app/api/ai/chat/route.ts`

**Method:** POST

**Body:**
```typescript
{
  message: string
  conversationHistory?: Array<{
    role: 'user' | 'assistant'
    content: string
  }>
}
```

**Response:**
```typescript
{
  response: string
  conversationId: string
  timestamp: string
}
```

**Features:**
```typescript
âœ… Natural language processing
âœ… Context-aware responses
âœ… Dashboard data access
âœ… Quick action suggestions
âœ… Conversation history
âœ… Cost tracking
âœ… Usage limits
```

---

### 5. AI Automation Status API

**Ø§Ù„Ù…Ø³Ø§Ø±:** `app/api/ai/automation-status/route.ts`

**Method:** GET

**Purpose:** Ø¬Ù„Ø¨ Ø­Ø§Ù„Ø© Ø§Ù„Ø£ØªÙ…ØªØ©

**Response:**
```typescript
{
  activeAutomations: number
  successRate: number
  timeSaved: number (minutes)
  upcomingActions: Array<{
    id: string
    type: string
    scheduledAt: string
    locationName: string
  }>
  aiResponseQuality: number (0-100)
  lastUpdated: string
}
```

**Features:**
```typescript
âœ… Real-time automation stats
âœ… Success rate calculation
âœ… Time saved estimation
âœ… Upcoming actions
âœ… Quality metrics
```

---

### 6. GMB Sync API

**Ø§Ù„Ù…Ø³Ø§Ø±:** `app/api/gmb/sync/route.ts`

**Method:** POST

**Body:**
```typescript
{
  accountId: string
  syncType: 'full' | 'reviews' | 'locations' | 'posts' | 'questions'
}
```

**Response:**
```typescript
{
  success: boolean
  message: string
  itemsSynced?: number
  cooldownRemaining?: number
}
```

**Features:**
```typescript
âœ… Rate limiting (60 seconds)
âœ… Partial sync support
âœ… Error handling
âœ… Logging (gmb_sync_logs)
âœ… Token refresh
âœ… Parallel syncing
```

---

## âš¡ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

### 1. Multi-Location Management (Ø¥Ø¯Ø§Ø±Ø© Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹)

```typescript
Features:
âœ… Connect multiple GMB accounts
âœ… Manage unlimited locations
âœ… Bulk operations
âœ… Location groups
âœ… Location-specific settings
âœ… Location comparison
âœ… Location search & filter
âœ… Location map view
âœ… Location health score
âœ… Profile completeness tracking
```

---

### 2. AI-Powered Reviews (Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ)

```typescript
Features:
âœ… AI-generated replies
âœ… Sentiment analysis
âœ… Review categorization
âœ… Bulk reply
âœ… Reply templates
âœ… Review filtering
âœ… Review trends
âœ… Negative review alerts
âœ… Review response time tracking
âœ… Review quality score
```

---

### 3. Q&A Management (Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ù„Ø£Ø¬ÙˆØ¨Ø©)

```typescript
Features:
âœ… Answer questions
âœ… AI-suggested answers
âœ… Question prioritization
âœ… Upvote tracking
âœ… Question filtering
âœ… Quick answers
âœ… Answer templates
âœ… Question trends
```

---

### 4. Posts Management (Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø§Øª)

```typescript
Features:
âœ… Create posts (What's New, Event, Offer)
âœ… Schedule posts
âœ… Post templates
âœ… AI-generated content
âœ… Media upload
âœ… CTA buttons
âœ… Post analytics
âœ… Post calendar
âœ… Bulk posting
âœ… Post preview
```

---

### 5. Media Gallery (Ù…Ø¹Ø±Ø¶ Ø§Ù„ÙˆØ³Ø§Ø¦Ø·)

```typescript
Features:
âœ… Photo management
âœ… Video management
âœ… Bulk upload
âœ… Media categorization
âœ… Media search
âœ… Media analytics
âœ… Media optimization
âœ… Media tagging
```

---

### 6. Advanced Analytics (ØªØ­Ù„ÙŠÙ„Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©)

```typescript
Features:
âœ… Performance metrics
âœ… Search keywords
âœ… Impressions breakdown
âœ… Click-through rates
âœ… Customer actions
âœ… Phone calls tracking
âœ… Direction requests
âœ… Website clicks
âœ… Custom reports
âœ… Export reports
âœ… Comparison periods
âœ… Location comparison
```

---

### 7. Smart Automation (Ø£ØªÙ…ØªØ© Ø°ÙƒÙŠØ©)

```typescript
Features:
âœ… Auto-reply to reviews
âœ… Auto-answer questions
âœ… Scheduled posts
âœ… Auto-sync
âœ… Alert notifications
âœ… Workflow automation
âœ… Custom rules
âœ… Automation logs
âœ… Success tracking
```

---

### 8. AI Chat Assistant (Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©)

```typescript
Features:
âœ… Natural language queries
âœ… Context-aware responses
âœ… Dashboard data access
âœ… Quick actions
âœ… Voice input (optional)
âœ… Conversation history
âœ… Copy responses
âœ… Minimize/maximize
```

---

### 9. AI Predictive Insights (Ø±Ø¤Ù‰ ØªÙ†Ø¨Ø¤ÙŠØ©)

```typescript
Features:
âœ… Business insights
âœ… Predictive analytics
âœ… Anomaly detection
âœ… Competitor comparison
âœ… Action recommendations
âœ… Impact assessment
âœ… Confidence scores
âœ… One-click actions
```

---

### 10. Real-time Sync (Ù…Ø²Ø§Ù…Ù†Ø© ÙÙˆØ±ÙŠØ©)

```typescript
Features:
âœ… Supabase Realtime subscriptions
âœ… Auto-refresh
âœ… Manual sync
âœ… Sync status indicator
âœ… Last sync timestamp
âœ… Sync logs
âœ… Error handling
âœ… Rate limiting
```

---

### 11. Reports & Export (ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØªØµØ¯ÙŠØ±)

```typescript
Features:
âœ… Export to PDF
âœ… Export to CSV
âœ… Export to Excel
âœ… Print reports
âœ… Custom date ranges
âœ… Widget selection
âœ… Branded reports
âœ… Share reports
```

---

### 12. Customization (Ø§Ù„ØªØ®ØµÙŠØµ)

```typescript
Features:
âœ… Widget visibility
âœ… Layout customization
âœ… Theme (Light/Dark)
âœ… Language (English/Arabic)
âœ… Date format
âœ… Timezone
âœ… Notifications preferences
âœ… Dashboard preferences
```

---

## ğŸ”„ ØªØ¯ÙÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

### Data Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    User                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Dashboard Page                     â”‚
â”‚  (app/[locale]/(dashboard)/dashboard/page.tsx) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           useDashboardSnapshot Hook             â”‚
â”‚        (hooks/use-dashboard-cache.ts)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         /api/dashboard/overview                 â”‚
â”‚    (app/api/dashboard/overview/route.ts)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Supabase Queries                   â”‚
â”‚  - v_dashboard_stats                            â”‚
â”‚  - mv_location_stats                            â”‚
â”‚  - v_health_score_distribution                  â”‚
â”‚  - get_dashboard_trends()                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PostgreSQL Database                â”‚
â”‚  - gmb_locations                                â”‚
â”‚  - gmb_reviews                                  â”‚
â”‚  - gmb_questions                                â”‚
â”‚  - gmb_posts                                    â”‚
â”‚  - etc.                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Response to Dashboard                 â”‚
â”‚         (DashboardSnapshot)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Render Dashboard Widgets               â”‚
â”‚  - Stats Cards                                  â”‚
â”‚  - Performance Chart                            â”‚
â”‚  - Location Highlights                          â”‚
â”‚  - Weekly Tasks                                 â”‚
â”‚  - Bottlenecks                                  â”‚
â”‚  - AI Insights                                  â”‚
â”‚  - etc.                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Sync Flow

```
User clicks "Sync GMB Data"
         â†“
SyncAllButton component
         â†“
syncAllGmbData() function
         â†“
POST /api/gmb/sync
         â†“
Check rate limit (60s cooldown)
         â†“
Get active GMB account
         â†“
Refresh access token (if needed)
         â†“
Parallel sync:
  â”œâ”€â”€ Sync Locations
  â”œâ”€â”€ Sync Reviews
  â”œâ”€â”€ Sync Questions
  â”œâ”€â”€ Sync Posts
  â””â”€â”€ Sync Media
         â†“
Update gmb_sync_logs
         â†“
Trigger database functions:
  â”œâ”€â”€ update_location_review_stats()
  â””â”€â”€ refresh_location_stats()
         â†“
Dispatch 'gmb-sync-complete' event
         â†“
Dashboard auto-refreshes
         â†“
Show success toast
```

---

### AI Insights Flow

```
Dashboard loads
         â†“
AIInsightsPanel component
         â†“
useEffect â†’ fetch insights
         â†“
GET /api/ai/insights
         â†“
Check cache (1 hour)
         â†“
If cached â†’ return cached data
         â†“
If not cached:
  â”œâ”€â”€ Get v_dashboard_stats
  â”œâ”€â”€ Prepare prompt
  â”œâ”€â”€ Call AI API (OpenAI/Anthropic/Google)
  â”œâ”€â”€ Parse response
  â”œâ”€â”€ Cache result
  â””â”€â”€ Log to ai_requests table
         â†“
Return insights to component
         â†“
Display insights with:
  â”œâ”€â”€ Impact level
  â”œâ”€â”€ Confidence score
  â”œâ”€â”€ Suggested actions
  â””â”€â”€ One-click buttons
```

---

## âš¡ Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„ØªØ­Ø³ÙŠÙ†

### Performance Optimizations

#### 1. Database Level

```sql
âœ… Materialized Views
   - mv_location_stats (refresh every 15 min)
   - Pre-aggregated data
   - Faster queries

âœ… Database Views
   - v_dashboard_stats
   - v_health_score_distribution
   - Simplified queries

âœ… Indexes
   - ~250 indexes
   - Covering indexes
   - Partial indexes
   - Full-text search indexes

âœ… Functions
   - get_dashboard_trends()
   - Efficient calculations
   - Reduced round trips

âœ… Triggers
   - Auto-update stats
   - Real-time calculations
   - No manual updates needed
```

---

#### 2. API Level

```typescript
âœ… Caching
   - Client-side cache (3-5 minutes)
   - Server-side cache (Redis - future)
   - Materialized views

âœ… Rate Limiting
   - Prevent abuse
   - 60s cooldown for sync
   - Per-user limits

âœ… Parallel Queries
   - Promise.all()
   - Concurrent fetching
   - Reduced latency

âœ… Pagination
   - Limit results
   - Cursor-based pagination
   - Infinite scroll

âœ… Compression
   - Gzip responses
   - Reduced bandwidth
```

---

#### 3. Frontend Level

```typescript
âœ… Code Splitting
   - Dynamic imports
   - Lazy loading
   - Reduced bundle size

âœ… Component Memoization
   - React.memo()
   - useMemo()
   - useCallback()

âœ… Virtual Scrolling
   - Large lists
   - Reduced DOM nodes
   - Better performance

âœ… Debouncing
   - Search inputs (500ms)
   - Reduced API calls

âœ… Optimistic Updates
   - Instant UI feedback
   - Background sync
   - Better UX

âœ… Loading Skeletons
   - Perceived performance
   - Better UX
   - Smooth transitions

âœ… Error Boundaries
   - Graceful degradation
   - Prevent full crashes
   - Better UX
```

---

### Performance Metrics

```
Target Metrics:
âœ… Page Load Time: < 3 seconds
âœ… Time to Interactive: < 5 seconds
âœ… First Contentful Paint: < 1.5 seconds
âœ… Largest Contentful Paint: < 2.5 seconds
âœ… Cumulative Layout Shift: < 0.1
âœ… First Input Delay: < 100ms

Lighthouse Score:
âœ… Performance: > 90
âœ… Accessibility: > 90
âœ… Best Practices: > 90
âœ… SEO: > 90
```

---

## ğŸ”’ Ø§Ù„Ø£Ù…Ø§Ù†

### Security Measures

#### 1. Authentication

```typescript
âœ… Supabase Auth
âœ… JWT tokens
âœ… Secure sessions
âœ… Password hashing (bcrypt)
âœ… Email verification
âœ… Password reset
âœ… 2FA (future)
```

---

#### 2. Authorization

```typescript
âœ… Row Level Security (RLS)
âœ… User-specific data access
âœ… Role-based access (future)
âœ… Permission checks
âœ… API key validation
```

---

#### 3. Data Protection

```typescript
âœ… Encryption at rest
âœ… Encryption in transit (HTTPS)
âœ… Token encryption (AES-256)
âœ… Sensitive data masking
âœ… Secure key storage (env vars)
```

---

#### 4. API Security

```typescript
âœ… Rate limiting
âœ… CSRF protection
âœ… Input validation
âœ… SQL injection prevention (Supabase)
âœ… XSS prevention (React)
âœ… CORS configuration
```

---

#### 5. Monitoring

```typescript
âœ… Error logging (error_logs table)
âœ… Audit logging (audit_logs table)
âœ… Activity logging (activity_logs table)
âœ… Performance monitoring
âœ… Security alerts
```

---

## ğŸ‘¨â€ğŸ’» Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø·ÙˆØ±

### Getting Started

#### 1. Prerequisites

```bash
Node.js >= 18
npm or pnpm
Supabase account
Google Cloud account (for GMB API)
AI API keys (OpenAI/Anthropic/Google)
```

---

#### 2. Installation

```bash
# Clone repository
git clone https://github.com/NN224/NNH-AI-Studio.git

# Install dependencies
cd NNH-AI-Studio
pnpm install

# Setup environment variables
cp .env.example .env.local

# Run database migrations
pnpm supabase db push

# Start development server
pnpm dev
```

---

#### 3. Environment Variables

```bash
# Supabase
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key

# Google OAuth
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
GOOGLE_REDIRECT_URI=http://localhost:3000/api/auth/callback/google

# AI APIs (System Keys)
SYSTEM_OPENAI_API_KEY=your_openai_key
SYSTEM_ANTHROPIC_API_KEY=your_anthropic_key
SYSTEM_GOOGLE_API_KEY=your_google_ai_key

# Encryption
ENCRYPTION_KEY=your_32_character_encryption_key

# App
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

---

### Project Structure

```
NNH-AI-Studio/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ [locale]/
â”‚   â”‚   â”œâ”€â”€ (dashboard)/
â”‚   â”‚   â”‚   â”œâ”€â”€ dashboard/          # Dashboard page
â”‚   â”‚   â”‚   â”œâ”€â”€ locations/          # Locations page
â”‚   â”‚   â”‚   â”œâ”€â”€ reviews/            # Reviews page
â”‚   â”‚   â”‚   â”œâ”€â”€ questions/          # Questions page
â”‚   â”‚   â”‚   â”œâ”€â”€ posts/              # Posts page
â”‚   â”‚   â”‚   â”œâ”€â”€ gmb-posts/          # GMB Posts page
â”‚   â”‚   â”‚   â”œâ”€â”€ media/              # Media page
â”‚   â”‚   â”‚   â”œâ”€â”€ analytics/          # Analytics page
â”‚   â”‚   â”‚   â”œâ”€â”€ features/           # Features page
â”‚   â”‚   â”‚   â”œâ”€â”€ automation/         # Automation page
â”‚   â”‚   â”‚   â””â”€â”€ settings/           # Settings page
â”‚   â”‚   â””â”€â”€ (auth)/
â”‚   â”‚       â”œâ”€â”€ login/              # Login page
â”‚   â”‚       â””â”€â”€ signup/             # Signup page
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â”‚   â”œâ”€â”€ stats/              # Stats API
â”‚   â”‚   â”‚   â””â”€â”€ overview/           # Overview API
â”‚   â”‚   â”œâ”€â”€ ai/
â”‚   â”‚   â”‚   â”œâ”€â”€ insights/           # AI Insights API
â”‚   â”‚   â”‚   â”œâ”€â”€ chat/               # AI Chat API
â”‚   â”‚   â”‚   â””â”€â”€ automation-status/  # Automation API
â”‚   â”‚   â””â”€â”€ gmb/
â”‚   â”‚       â”œâ”€â”€ sync/               # Sync API
â”‚   â”‚       â””â”€â”€ accounts/           # Accounts API
â”‚   â””â”€â”€ globals.css
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ dashboard/                  # Dashboard components
â”‚   â”‚   â”œâ”€â”€ ai/                     # AI components
â”‚   â”‚   â”œâ”€â”€ stats-cards.tsx
â”‚   â”‚   â”œâ”€â”€ quick-actions-bar.tsx
â”‚   â”‚   â”œâ”€â”€ weekly-tasks-widget.tsx
â”‚   â”‚   â”œâ”€â”€ bottlenecks-widget.tsx
â”‚   â”‚   â”œâ”€â”€ performance-comparison-chart.tsx
â”‚   â”‚   â”œâ”€â”€ date-range-controls.tsx
â”‚   â”‚   â”œâ”€â”€ export-share-bar.tsx
â”‚   â”‚   â”œâ”€â”€ realtime-updates-indicator.tsx
â”‚   â”‚   â”œâ”€â”€ dashboard-error-boundary.tsx
â”‚   â”‚   â”œâ”€â”€ responsive-layout.tsx
â”‚   â”‚   â””â”€â”€ lazy-dashboard-components.tsx
â”‚   â”œâ”€â”€ ui/                         # shadcn/ui components
â”‚   â”œâ”€â”€ layout/                     # Layout components
â”‚   â””â”€â”€ ...
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ use-dashboard-cache.ts      # Dashboard cache hook
â”‚   â”œâ”€â”€ use-dashboard.ts            # Dashboard hook
â”‚   â””â”€â”€ ...
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ supabase/                   # Supabase client
â”‚   â”œâ”€â”€ security/                   # Security utilities
â”‚   â”œâ”€â”€ services/                   # Business logic
â”‚   â”œâ”€â”€ utils/                      # Utility functions
â”‚   â””â”€â”€ ...
â”œâ”€â”€ server/
â”‚   â””â”€â”€ actions/                    # Server actions
â”œâ”€â”€ types/
â”‚   â””â”€â”€ dashboard.ts                # Dashboard types
â”œâ”€â”€ supabase/
â”‚   â””â”€â”€ migrations/                 # Database migrations
â”œâ”€â”€ messages/
â”‚   â”œâ”€â”€ en.json                     # English translations
â”‚   â””â”€â”€ ar.json                     # Arabic translations
â””â”€â”€ ...
```

---

### Adding a New Widget

#### 1. Create Component

```typescript
// components/dashboard/my-new-widget.tsx
'use client';

import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';

export function MyNewWidget() {
  return (
    <Card>
      <CardHeader>
        <CardTitle>My New Widget</CardTitle>
      </CardHeader>
      <CardContent>
        {/* Widget content */}
      </CardContent>
    </Card>
  );
}
```

---

#### 2. Add to Dashboard

```typescript
// app/[locale]/(dashboard)/dashboard/page.tsx
import { MyNewWidget } from '@/components/dashboard/my-new-widget';

// In the component:
<DashboardSection section="My New Widget">
  <MyNewWidget />
</DashboardSection>
```

---

#### 3. Add to Preferences

```typescript
// lib/dashboard-preferences.ts
export interface DashboardWidgetPreferences {
  // ... existing preferences
  showMyNewWidget: boolean;
}

export const DEFAULT_PREFERENCES: DashboardWidgetPreferences = {
  // ... existing defaults
  showMyNewWidget: true,
};
```

---

#### 4. Add to Customization Modal

```typescript
// components/dashboard/dashboard-customization-modal.tsx
<div>
  <input
    type="checkbox"
    checked={preferences.showMyNewWidget}
    onChange={(e) => handleChange('showMyNewWidget', e.target.checked)}
  />
  <label>Show My New Widget</label>
</div>
```

---

### Testing

```bash
# Run unit tests
pnpm test

# Run E2E tests
pnpm test:e2e

# Run linter
pnpm lint

# Run type check
pnpm type-check

# Run build
pnpm build
```

---

### Deployment

```bash
# Build for production
pnpm build

# Deploy to Vercel
vercel --prod

# Run database migrations
pnpm supabase db push --linked
```

---

## ğŸ“ Ø§Ù„Ø®Ù„Ø§ØµØ©

### Ù…Ø§ ØªÙ… Ø¥Ù†Ø¬Ø§Ø²Ù‡

```
âœ… Dashboard ØµÙØ­Ø© Ø±Ø¦ÙŠØ³ÙŠØ© ÙƒØ§Ù…Ù„Ø©
âœ… 33 Ù…ÙƒÙˆÙ† Dashboard
âœ… 5 API Routes
âœ… 20 Ø¬Ø¯ÙˆÙ„ ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
âœ… 3 Views Ù…Ø­Ø³Ù‘Ù†Ø©
âœ… ~85 Ø¯Ø§Ù„Ø©
âœ… 17 Ù…Ø´ØºÙ„
âœ… ~250 ÙÙ‡Ø±Ø³
âœ… ~150 Ø³ÙŠØ§Ø³Ø© RLS
âœ… Ù…ÙŠØ²Ø§Øª AI Ù…ØªÙ‚Ø¯Ù…Ø©
âœ… Ù…Ø²Ø§Ù…Ù†Ø© ÙÙˆØ±ÙŠØ©
âœ… ØªØ­Ù„ÙŠÙ„Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©
âœ… Ø£ØªÙ…ØªØ© Ø°ÙƒÙŠØ©
âœ… ØªØµØ¯ÙŠØ± ØªÙ‚Ø§Ø±ÙŠØ±
âœ… ØªØ®ØµÙŠØµ Dashboard
âœ… Ø¯Ø¹Ù… Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ù„ØºØ§Øª (English/Arabic)
âœ… Ø¯Ø¹Ù… Dark Mode
âœ… ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨
âœ… Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ (WCAG 2.1 AA)
âœ… Ø£Ù…Ø§Ù† Ù…Ø­Ø³Ù‘Ù†
âœ… Ø£Ø¯Ø§Ø¡ Ù…Ø­Ø³Ù‘Ù†
âœ… ØªÙˆØ«ÙŠÙ‚ ÙƒØ§Ù…Ù„
```

---

### Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©

```
ğŸ”® Drag & Drop Widgets
ğŸ”® Widget Resizing
ğŸ”® Custom Dashboards
ğŸ”® Team Collaboration
ğŸ”® Role-based Access
ğŸ”® White Label
ğŸ”® Mobile App
ğŸ”® Voice Commands
ğŸ”® Advanced AI Features
ğŸ”® Competitor Tracking
ğŸ”® Sentiment Trends
ğŸ”® Predictive Analytics
ğŸ”® Automated Reports
ğŸ”® Webhooks
ğŸ”® API Access
```

---

### Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©

```
ğŸ“¦ Ø§Ù„Ù…Ù„ÙØ§Øª:              ~45 Ù…Ù„Ù
ğŸ“ Ø§Ù„Ø£Ø³Ø·Ø±:               ~8,889 Ø³Ø·Ø±
ğŸ§© Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª:             33 Ù…ÙƒÙˆÙ†
ğŸ“Š API Routes:           5 routes
ğŸ—„ï¸ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„:              20 Ø¬Ø¯ÙˆÙ„
ğŸ“ˆ Views:                3 views
âš¡ Functions:            ~85 function
ğŸ”¥ Triggers:             17 trigger
ğŸ“‘ Indexes:              ~250 index
ğŸ”’ RLS Policies:         ~150 policy
ğŸŒ Languages:            2 (English/Arabic)
ğŸ¨ Themes:               2 (Light/Dark)
ğŸ“± Responsive:           âœ… Mobile/Tablet/Desktop
â™¿ Accessibility:        âœ… WCAG 2.1 AA
ğŸš€ Performance:          âœ… Lighthouse > 90
ğŸ” Security:             âœ… Production Ready
```

---

**Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¬Ø§Ù‡Ø² 100% Ù„Ù„Ø¥Ù†ØªØ§Ø¬! ğŸ‰ğŸš€**

---

**ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ø¨ÙˆØ§Ø³Ø·Ø©:** AI Assistant  
**Ø§Ù„ØªØ§Ø±ÙŠØ®:** 16 Ù†ÙˆÙÙ…Ø¨Ø± 2025  
**Ø§Ù„Ø¥ØµØ¯Ø§Ø±:** 2.0  
**Ø§Ù„Ø­Ø§Ù„Ø©:** Production Ready âœ…

